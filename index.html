<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SkyPath - Real-time Flight Tracker</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div id="globe-container"></div>

  <!-- Filters Sidebar -->
  <div id="filters-sidebar" class="hidden" role="dialog" aria-label="Flight filters">
    <div class="sidebar-header">
      <h2>Filters</h2>
      <button id="close-filters" aria-label="Close filters">&times;</button>
    </div>

    <div class="filter-section">
      <div class="filter-header">
        <label class="filter-title" id="country-filter-label">Filter by Country</label>
        <label class="toggle-switch">
          <input type="checkbox" id="filter-country-toggle" aria-labelledby="country-filter-label">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="filter-content" id="country-filter-content">
        <select id="filter-country-select" disabled aria-label="Select country">
          <option value="">Select a country...</option>
        </select>
        <p class="filter-hint">Focus globe and show flights from country</p>
      </div>
    </div>

    <div class="filter-section">
      <div class="filter-header">
        <label class="filter-title" id="state-filter-label">Filter by US State</label>
        <label class="toggle-switch">
          <input type="checkbox" id="filter-state-toggle" aria-labelledby="state-filter-label">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="filter-content" id="state-filter-content">
        <select id="filter-state-select" disabled aria-label="Select US state">
          <option value="">Select a state...</option>
        </select>
        <p class="filter-hint">Shows flights over selected state</p>
      </div>
    </div>

    <div class="filter-section">
      <div class="filter-header">
        <label class="filter-title" id="airport-filter-label">Filter by Airport</label>
        <label class="toggle-switch">
          <input type="checkbox" id="filter-airport-toggle" aria-labelledby="airport-filter-label">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="filter-content" id="airport-filter-content">
        <select id="filter-airport-select" disabled aria-label="Select airport">
          <option value="">Select an airport...</option>
        </select>
        <p class="filter-hint">Shows flights near selected airport</p>
      </div>
    </div>

    <div class="filter-section">
      <div class="filter-header">
        <label class="filter-title" id="altitude-filter-label">Filter by Altitude</label>
        <label class="toggle-switch">
          <input type="checkbox" id="filter-altitude-toggle" aria-labelledby="altitude-filter-label">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="filter-content" id="altitude-filter-content">
        <div class="altitude-slider-container">
          <input type="range" id="filter-altitude-min" min="0" max="45000" value="0" step="1000" disabled aria-label="Minimum altitude in feet">
          <div class="altitude-labels">
            <span id="altitude-min-label">0 ft</span>
            <span id="altitude-max-label">45,000 ft</span>
          </div>
        </div>
        <p class="filter-hint">Show flights above minimum altitude</p>
      </div>
    </div>

    <div class="filter-section">
      <div class="filter-header">
        <label class="filter-title" id="airline-filter-label">Filter by Airline</label>
        <label class="toggle-switch">
          <input type="checkbox" id="filter-airline-toggle" aria-labelledby="airline-filter-label">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="filter-content" id="airline-filter-content">
        <select id="filter-airline-select" disabled aria-label="Select airline">
          <option value="">Select an airline...</option>
        </select>
        <p class="filter-hint">Shows flights from selected airline</p>
      </div>
    </div>

    <button id="clear-filters" class="clear-btn">Clear All Filters</button>
  </div>

  <div id="ui-overlay">
    <header id="header">
      <div class="header-text">
        <div class="logo-title">
          <svg class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="36" height="36" aria-hidden="true">
            <defs>
              <linearGradient id="logo-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#a78bfa"/>
                <stop offset="100%" style="stop-color:#7aa2f7"/>
              </linearGradient>
            </defs>
            <circle cx="32" cy="32" r="28" fill="none" stroke="url(#logo-gradient)" stroke-width="2" opacity="0.4"/>
            <ellipse cx="32" cy="32" rx="28" ry="10" fill="none" stroke="url(#logo-gradient)" stroke-width="1" opacity="0.3"/>
            <path d="M12 40 Q32 8 52 40" fill="none" stroke="url(#logo-gradient)" stroke-width="2.5" stroke-linecap="round"/>
            <g transform="translate(44, 24) rotate(45)">
              <path d="M0 -8 L3 -2 L8 0 L3 2 L0 8 L-3 2 L-8 0 L-3 -2 Z" fill="url(#logo-gradient)"/>
            </g>
            <circle cx="18" cy="36" r="2" fill="url(#logo-gradient)" opacity="0.4"/>
            <circle cx="26" cy="26" r="2" fill="url(#logo-gradient)" opacity="0.6"/>
            <circle cx="35" cy="22" r="2" fill="url(#logo-gradient)" opacity="0.8"/>
          </svg>
          <h1>SkyPath</h1>
        </div>
        <p class="subtitle">Real-time Global Flight Tracker</p>
      </div>
      <div class="header-controls">
        <div id="search-container">
          <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
          <input type="text" id="location-search" placeholder="Search country or region..." autocomplete="off" aria-label="Search country or region">
          <div id="search-results" class="hidden" role="listbox"></div>
        </div>
        <button id="btn-filters" title="Filters" aria-label="Open filters">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="url(#filter-gradient)" stroke-width="2" aria-hidden="true">
            <defs>
              <linearGradient id="filter-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#a78bfa"/>
                <stop offset="100%" style="stop-color:#7aa2f7"/>
              </linearGradient>
            </defs>
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
          </svg>
          <span>Filters</span>
        </button>
      </div>
    </header>

    <div id="stats-panel" aria-label="Flight statistics">
      <div class="stat">
        <span class="stat-value" id="flight-count">--</span>
        <span class="stat-label">Active Flights</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="country-count">--</span>
        <span class="stat-label">Countries</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="zoom-level">--</span>
        <span class="stat-label">Zoom</span>
      </div>
    </div>

    <article id="flight-info" class="hidden" aria-label="Flight details">
      <button id="close-info" aria-label="Close flight info">&times;</button>
      <h2 id="info-callsign">--</h2>
      <p class="info-airline" id="info-airline"></p>
      <div class="info-route">
        <span id="info-origin">--</span>
        <span class="route-arrow" aria-hidden="true">→</span>
        <span id="info-destination">--</span>
      </div>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Altitude</span>
          <span class="info-value" id="info-altitude">--</span>
        </div>
        <div class="info-item">
          <span class="info-label">Ground Speed</span>
          <span class="info-value" id="info-speed">--</span>
        </div>
        <div class="info-item">
          <span class="info-label">Heading</span>
          <span class="info-value" id="info-heading">--</span>
        </div>
        <div class="info-item">
          <span class="info-label">Vertical Rate</span>
          <span class="info-value" id="info-vertical">--</span>
        </div>
        <div class="info-item">
          <span class="info-label">Squawk</span>
          <span class="info-value" id="info-squawk">--</span>
        </div>
        <div class="info-item">
          <span class="info-label">Coordinates</span>
          <span class="info-value" id="info-coords">--</span>
        </div>
      </div>
    </article>

    <!-- Hover tooltip (follows cursor) -->
    <div id="flight-hover-tooltip" class="hidden" role="tooltip">
      <div class="tooltip-callsign" id="tooltip-callsign">--</div>
      <div class="tooltip-route">
        <span id="tooltip-origin">--</span>
        <span class="tooltip-arrow" aria-hidden="true">→</span>
        <span id="tooltip-destination">--</span>
      </div>
      <div class="tooltip-details">
        <span id="tooltip-altitude">--</span>
        <span class="tooltip-separator" aria-hidden="true">•</span>
        <span id="tooltip-speed">--</span>
      </div>
    </div>
  </div>

  <div id="controls" role="toolbar" aria-label="Map controls">
    <button id="btn-reset" title="Reset View (R)" aria-label="Reset view">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8" x2="12" y2="12"/>
        <line x1="12" y1="12" x2="15" y2="15"/>
      </svg>
    </button>
    <button id="btn-toggle-arcs" title="Toggle Flight Arcs (A)" aria-label="Toggle flight arcs">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M22 2L11 13"/>
        <path d="M22 2L15 22L11 13L2 9L22 2Z"/>
      </svg>
    </button>
    <button id="btn-fullscreen" title="Fullscreen (F)" aria-label="Toggle fullscreen">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
      </svg>
    </button>
    <button id="btn-flights-list" title="Flight List (L)" aria-label="Show flight list">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" aria-hidden="true">
        <line x1="4" y1="6" x2="20" y2="6"/>
        <line x1="4" y1="12" x2="20" y2="12"/>
        <line x1="4" y1="18" x2="20" y2="18"/>
      </svg>
    </button>
    <button id="btn-stats" title="Statistics (S)" aria-label="Show statistics">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <line x1="18" y1="20" x2="18" y2="10"/>
        <line x1="12" y1="20" x2="12" y2="4"/>
        <line x1="6" y1="20" x2="6" y2="14"/>
      </svg>
    </button>
  </div>

  <!-- Flight List Panel -->
  <div id="flights-list-panel" class="hidden" role="dialog" aria-label="Flight list">
    <div class="panel-header">
      <h2>Flights</h2>
      <button id="close-flights-list" aria-label="Close flight list">&times;</button>
    </div>
    <div class="flights-list-controls">
      <input type="text" id="flights-search" placeholder="Search callsign..." aria-label="Search flights by callsign">
      <select id="flights-sort" aria-label="Sort flights by">
        <option value="callsign">Callsign</option>
        <option value="altitude">Altitude</option>
        <option value="speed">Speed</option>
        <option value="airline">Airline</option>
      </select>
    </div>
    <div id="flights-list-content" role="list"></div>
  </div>

  <!-- Stats Panel -->
  <div id="stats-dashboard" class="hidden" role="dialog" aria-label="Statistics dashboard">
    <div class="panel-header">
      <h2>Statistics</h2>
      <button id="close-stats" aria-label="Close statistics">&times;</button>
    </div>
    <div id="stats-content">
      <div class="stat-section">
        <h3>Top Airlines</h3>
        <div id="top-airlines"></div>
      </div>
      <div class="stat-section">
        <h3>Altitude Distribution</h3>
        <div id="altitude-chart"></div>
      </div>
      <div class="stat-section">
        <h3>Flights by Country</h3>
        <div id="country-chart"></div>
      </div>
    </div>
  </div>

  <!-- Attribution -->
  <div id="attribution">
    Flight data by <a href="https://opensky-network.org" target="_blank" rel="noopener">OpenSky Network</a>
  </div>

  <div id="loading" aria-live="polite">
    <div class="spinner" aria-hidden="true"></div>
    <p>Loading flight data...</p>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
